# Сервис подсчёта арифметических выражений. Программирование на Go | 24. Спринт 1
REST API для вычисления арифметических выражений.
> [!IMPORTANT]
>  Если у вас возникли проблемы - не ставьте мне ноль баллов , а лучше напишите сюда в тг -> @rmarsu

## Описание
Этот проект представляет собой веб-сервис, который позволяет пользователям отправлять арифметические выражения и получать результаты их вычисления. Сервис реализует один endpoint, который обрабатывает *POST*-запросы с арифметическими выражениями.
  
<div align="center">
  ..................
</div>

> [!IMPORTANT]
> ### Сервис поддерживает обработку таких символов как:
> | Символ | Возможная ошибка | Описание |
> | --- | --- | --- |
> | Целое число ([int64](https://pkg.go.dev/builtin#int64)) | Число превосходит максимальное значение [int64](https://pkg.go.dev/builtin#int64) | [Просто целое число](https://ru.wikipedia.org/wiki/%D0%A6%D0%B5%D0%BB%D0%BE%D0%B5_%D1%87%D0%B8%D1%81%D0%BB%D0%BE)|
> | Число с плавающей точкой ([float64](https://pkg.go.dev/builtin#float64))| Число превосходит максимальное значение [float64](https://pkg.go.dev/builtin#float64) | [Просто число с плавающей точкой](https://ru.wikipedia.org/wiki/%D0%A7%D0%B8%D1%81%D0%BB%D0%BE_%D1%81_%D0%BF%D0%BB%D0%B0%D0%B2%D0%B0%D1%8E%D1%89%D0%B5%D0%B9_%D0%B7%D0%B0%D0%BF%D1%8F%D1%82%D0%BE%D0%B9)|
> | + | - | Складывает числа. Минимальный приоритет|
> | - | - | Вычитает числа. Минимальный приоритет |
> | / | Деление на 0 | Деление чисел. Приоритет выше чем у + и - |
> | * | - | Умножение чисел. Приоритет выше чем у + и - |
> | () Группировка | Незакрытая скобка | Группирование действий. Повышает приоритет действия |
<div align="center">
  ..................
</div>

> [!IMPORTANT]
> ### Эндпоинты
> | Эндпоинт | Допустимые методы | Описание |
> | --- | --- | --- |
> | /api/v1/calculate | *POST* | Получает POST-запрос c телом запроса в формате [JSON](https://ru.wikipedia.org/wiki/JSON), содержащим выражение. |
> | /api/v1/expressions | *GET* | Получает все выражения |
> | /api/v1/expressions/:id | *GET* | Получает выражение по его UUID |
> | /internal/task | *GET* | Получает простое арифметическое выражение как "задачу" |
> | /internal/task | *POST* | Принимает результат задачи |



## Для запуска
> [!IMPORTANT]
> Если случилась ошибка ,  <ins>убедитесь что установлена версия Go `1.23.3`</ins>.
> Последнюю версию можно установить [здесь](https://go.dev/dl/).

Не забудьте установить зависимости командой:
```shell
$ go mod tidy
```
> [!IMPORTANT]
> Перед запуском создайте файл .env в корне проекта. Он должен содержать такие данные как:
> ```
> COMPUTING_POWER = 10
>
> ORCHESTRATOR_PORT = "50050"
> AGENT_PORT = "50051"
>
> TIME_ADDITION_MS = 20
> TIME_SUBTRACTION_MS = 10
> TIME_MULTIPLICATION_MS = 35
> TIME_DIVISION_MS = 10
> ```

Для запуска можете воспользоваться Makefile-ом
```shell
$ make run
```
или запустить вручную:
```shell
$ go run cmd/main.go
```

## Примеры использования с cURL:

| cURL команда                                   | Ответ                                     | *HTTP* код
|------------------------------------------------|-------------------------------------------| ----------------------------- |
| ```curl -XPOST -d '{ "expression" : "2 + 2 * 2" }' 'http://localhost:50050/api/v1/calculate'```  | ```{"id":"some-id","status":"pending","result":0} ``` | 201 |
| ```curl -XPOST -d '{ "expression" : "2 @ 2"}' 'http://localhost:50050/api/v1/calculate'``` | ```{"error":"невалидное выражение"}```|422|
| ```curl -XPOST -d '{ "expression" : "2 -2"' 'http://localhost:50050/api/v1/calculate'``` | ```{"error":"Ошибка при парсинге JSON"}```|400|
| ```curl --location 'localhost:50050/api/v1/expressions'``` | ```{ "expressions": [ { "id": <идентификатор выражения>, "status": <статус вычисления выражения>, "result": <результат выражения> }, { "id": <идентификатор выражения>, "status": <статус вычисления выражения>, "result": <результат выражения> } ] }``` | 200 |
| ```curl --location 'localhost:50050/api/v1/expressions/:id'``` | ```{ "expression": { "id": <идентификатор выражения>, "status": <статус вычисления выражения>, "result": <результат выражения> } }``` | 200 |
| ```curl --location 'localhost:50050/api/v1/expressions/:id'``` | ```{"error":"Извините, выражение не найдено"}```  | 404 |
| ```curl --location 'localhost:50050/internal/task'``` |  ```{ "task": { "id": <идентификатор задачи>, "arg1": <имя первого аргумента>, "arg2": <имя второго аргумента>, "operation": <операция>, "operation_time": <время выполнения операции> } }``` | 200 |
| ```curl --location 'localhost:50050/internal/task'``` |  ```{"error":"Нет доступных задач"}``` | 404 |
| ```curl -XPOST -d '{ "id" : "some_id", "result" : 2.5 }' 'http://localhost:50050/internal/task' ```| ```""```| 200 |
| ```curl -XPOST -d '{ "id" : "some_id", "result" : 2.5 }' 'http://localhost:50050/internal/task' ```| ```{"error":"задача не найдена"}```| 404 |
| ```curl -XPOST -d '{ "id" : "some_id", "result" :: 2.5 }' 'http://localhost:50050/internal/task' ```| ```{"error":"Ошибка при парсинге JSON"}```| 400 |



> [!CAUTION]
> При использовании powershell или cmd могут возникуть проблемы с работой cURL , так как в них нельзя использовать одинарные кавычки. Можете воспользоваться аналогами , такими как : [Postman](https://www.postman.com/) или [WSL](https://en.wikipedia.org/wiki/Windows_Subsystem_for_Linux) . 

## Лицензия
[MIT](LICENSE)




